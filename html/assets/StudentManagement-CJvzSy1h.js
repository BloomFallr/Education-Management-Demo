import{r as d,o as k,L as M,I as t,k as G,H as e,t as b,z as J,j as A,O as K,l as E,w as Q,P as W}from"./index-CauhVxhf.js";import{b as X,v as Y}from"./el-message-box-72ezgMD2.js";import{E as Z,a as ee,b as ae}from"./el-main-1zPLywyB.js";import{E as te}from"./el-pagination-tu8S2-45.js";import{E as R,a as $}from"./el-message-BlXH8VcA.js";import{E as le,a as ne}from"./el-table-column-DDc4vDH_.js";import"./el-popper-CqdONIHR.js";import{E as oe}from"./el-empty-DlBGokpv.js";import{E as h,a as D}from"./el-form-item-C075O6SC.js";import{b as P,s as B,e as re}from"./constants-DWAz7ei8.js";import{E as ue}from"./el-dialog-B2TCSZSx.js";import"./el-overlay-IdPhgn1o.js";import{g as ie,h as de,i as se,j as pe}from"./adm-M6jV_13o.js";import{E as z}from"./request-BnFEnbez.js";import"./aria-nkjrUMQ-.js";import"./focus-trap-CBJl3iZD.js";import"./index-r5W6hzzQ.js";import"./vnode-RFtRU_sW.js";const me={class:"dialog-footer"},ce={__name:"StudentEdit",emits:["success"],setup(I,{expose:g,emit:V}){const s=d(!1),n=V,a=d({id:"",username:"",name:"",department:"",obtainedCredit:"",failedCredit:"",gpa:""}),S=d({username:[{required:!0,message:"请输入学号",trigger:"blur"},{pattern:/^\S{1,10}$/,message:"学号必须为1-10位非空字符",trigger:"blur"}],name:[{required:!0,message:"请输入姓名",trigger:"blur"},{pattern:/^\S{1,10}$/,message:"姓名必须为1-10位非空字符",trigger:"blur"}],department:[{required:!0,message:"请选择学院",trigger:"blur"},{pattern:/^\S{1,15}$/,message:"学院必须为1-15位非空字符",trigger:"blur"}]});g({open:_=>{s.value=!0,a.value={..._},JSON.stringify(_)=="{}"&&(a.value.obtainedCredit=0,a.value.failedCredit=0,a.value.gpa=0)}});const c=d(),y=()=>{c.value.clearValidate(),s.value=!1},x=async()=>{await c.value.validate(),a.value.id?(await ie(a.value),z.success("编辑成功")):(await de(a.value),z.success("添加成功")),s.value=!1,n("success")};return(_,o)=>{const p=R,m=h,r=D,u=$,C=ue;return k(),M(C,{modelValue:s.value,"onUpdate:modelValue":o[6]||(o[6]=l=>s.value=l),title:a.value.id?"编辑学生":"添加学生",width:"500",draggable:"",overflow:""},{footer:t(()=>[G("div",me,[e(u,{onClick:y},{default:t(()=>[b("取消")]),_:1}),e(u,{type:"primary",onClick:x},{default:t(()=>[b("确认")]),_:1})])]),default:t(()=>[e(r,{ref_key:"formRef",ref:c,model:a.value,rules:S.value,"label-width":"100px",style:{"padding-right":"30px"}},{default:t(()=>[e(m,{label:"学号",prop:"username"},{default:t(()=>[e(p,{placeholder:"请输入学号",modelValue:a.value.username,"onUpdate:modelValue":o[0]||(o[0]=l=>a.value.username=l)},null,8,["modelValue"])]),_:1}),e(m,{label:"姓名",prop:"name"},{default:t(()=>[e(p,{placeholder:"请输入姓名",modelValue:a.value.name,"onUpdate:modelValue":o[1]||(o[1]=l=>a.value.name=l)},null,8,["modelValue"])]),_:1}),e(m,{label:"学院",prop:"department"},{default:t(()=>[e(p,{placeholder:"请输入学院",modelValue:a.value.department,"onUpdate:modelValue":o[2]||(o[2]=l=>a.value.department=l)},null,8,["modelValue"])]),_:1}),e(m,{label:"已获学分",prop:"obtainedCredit"},{default:t(()=>[e(p,{disabled:"",modelValue:a.value.obtainedCredit,"onUpdate:modelValue":o[3]||(o[3]=l=>a.value.obtainedCredit=l)},null,8,["modelValue"])]),_:1}),e(m,{label:"不及格学分",prop:"failedCredit"},{default:t(()=>[e(p,{disabled:"",modelValue:a.value.failedCredit,"onUpdate:modelValue":o[4]||(o[4]=l=>a.value.failedCredit=l)},null,8,["modelValue"])]),_:1}),e(m,{label:"平均绩点",prop:"gpa"},{default:t(()=>[e(p,{disabled:"",modelValue:a.value.gpa,"onUpdate:modelValue":o[5]||(o[5]=l=>a.value.gpa=l)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}},Re={__name:"StudentManagement",setup(I){const g=d(!1),V=d([]),s=d(0),n=d({name:"",department:"",pageSize:10,currentPage:1}),a=async()=>{g.value=!0;const r=await se(n.value);V.value=r.data.data.list,s.value=r.data.data.total,g.value=!1},S=()=>{n.value.currentPage=1,a()},w=()=>{n.value.name="",n.value.department="",n.value.currentPage=1,a()};J(()=>{a()});const c=d(),y=()=>{c.value.open({})},x=r=>{c.value.open(r)},_=()=>{a()},o=async r=>{await X.confirm("您确定要删除该学生吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",icon:W(P)}).then(async()=>{await pe(r.id),z.success("删除成功")}),a()},p=r=>{n.value.currentPage=r,a()},m=r=>{n.value.pageSize=r,a()};return(r,u)=>{const C=R,l=h,v=$,U=D,T=ee,f=le,H=oe,L=ne,N=te,j=ae,q=Z,F=Y;return k(),A(K,null,[e(q,null,{default:t(()=>[e(T,null,{default:t(()=>[e(U,{inline:""},{default:t(()=>[e(l,null,{default:t(()=>[e(C,{modelValue:n.value.name,"onUpdate:modelValue":u[0]||(u[0]=i=>n.value.name=i),placeholder:"姓名","prefix-icon":E(B)},null,8,["modelValue","prefix-icon"])]),_:1}),e(l,null,{default:t(()=>[e(C,{modelValue:n.value.department,"onUpdate:modelValue":u[1]||(u[1]=i=>n.value.department=i),placeholder:"学院","prefix-icon":E(B)},null,8,["modelValue","prefix-icon"])]),_:1}),e(l,{style:{float:"inline-end"}},{default:t(()=>[e(v,{type:"primary",onClick:w,round:"",plain:""},{default:t(()=>[b("重置")]),_:1})]),_:1}),e(l,{style:{float:"inline-end"}},{default:t(()=>[e(v,{type:"primary",onClick:S,round:"",plain:""},{default:t(()=>[b("搜索")]),_:1})]),_:1})]),_:1})]),_:1}),e(j,null,{default:t(()=>[Q((k(),M(L,{data:V.value,border:"",style:{width:"100%"},height:"580px"},{empty:t(()=>[e(H,{description:"没有数据"})]),default:t(()=>[e(f,{prop:"username",label:"学号"}),e(f,{prop:"name",label:"姓名"}),e(f,{prop:"department",label:"学院"}),e(f,{prop:"obtainedCredit",label:"已获学分"}),e(f,{prop:"failedCredit",label:"不及格学分"}),e(f,{prop:"gpa",label:"平均绩点"}),e(f,{fixed:"right",label:"操作"},{default:t(({row:i})=>[e(v,{size:"small",type:"primary",onClick:O=>x(i),icon:E(re),circle:"",plain:""},null,8,["onClick","icon"]),e(v,{size:"small",type:"danger",onClick:O=>o(i),icon:E(P),circle:"",plain:""},null,8,["onClick","icon"])]),_:1})]),_:1},8,["data"])),[[F,g.value]]),e(U,{inline:"",style:{"margin-top":"10px","text-align":"right"}},{default:t(()=>[e(l,null,{default:t(()=>[e(v,{type:"primary",onClick:y,plain:""},{default:t(()=>[b("添加学生")]),_:1})]),_:1}),e(l,null,{default:t(()=>[e(N,{"current-page":n.value.currentPage,"onUpdate:currentPage":u[2]||(u[2]=i=>n.value.currentPage=i),"page-size":n.value.pageSize,"onUpdate:pageSize":u[3]||(u[3]=i=>n.value.pageSize=i),background:!0,"page-sizes":[10,15,20,25],layout:"sizes, total, prev, pager, next, jumper",total:s.value,onCurrentChange:p,onSizeChange:m},null,8,["current-page","page-size","total"])]),_:1})]),_:1})]),_:1})]),_:1}),e(ce,{ref_key:"studentEditRef",ref:c,onSuccess:_},null,512)],64)}}};export{Re as default};
